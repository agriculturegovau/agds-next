import{r}from"./index-f0f3a68d.js";import{f as x}from"./ComboboxListItem-78231edd.js";function N(s,t,l){var S=this,c=r.useRef(null),f=r.useRef(0),e=r.useRef(null),p=r.useRef([]),d=r.useRef(),i=r.useRef(),w=r.useRef(s),E=r.useRef(!0);r.useEffect(function(){w.current=s},[s]);var a=!t&&t!==0&&typeof window<"u";if(typeof s!="function")throw new TypeError("Expected a function");t=+t||0;var n=!!(l=l||{}).leading,I=!("trailing"in l)||!!l.trailing,m="maxWait"in l,R=m?Math.max(+l.maxWait||0,t):null;r.useEffect(function(){return E.current=!0,function(){E.current=!1}},[]);var A=r.useMemo(function(){var v=function(u){var o=p.current,g=d.current;return p.current=d.current=null,f.current=u,i.current=w.current.apply(g,o)},y=function(u,o){a&&cancelAnimationFrame(e.current),e.current=a?requestAnimationFrame(u):setTimeout(u,o)},h=function(u){if(!E.current)return!1;var o=u-c.current;return!c.current||o>=t||o<0||m&&u-f.current>=R},O=function(u){return e.current=null,I&&p.current?v(u):(p.current=d.current=null,i.current)},_=function u(){var o=Date.now();if(h(o))return O(o);if(E.current){var g=t-(o-c.current),k=m?Math.min(g,R-(o-f.current)):g;y(u,k)}},T=function(){var u=Date.now(),o=h(u);if(p.current=[].slice.call(arguments),d.current=S,c.current=u,o){if(!e.current&&E.current)return f.current=c.current,y(_,t),n?v(c.current):i.current;if(m)return y(_,t),v(c.current)}return e.current||y(_,t),i.current};return T.cancel=function(){e.current&&(a?cancelAnimationFrame(e.current):clearTimeout(e.current)),f.current=0,p.current=c.current=d.current=e.current=null},T.isPending=function(){return!!e.current},T.flush=function(){return e.current?O(Date.now()):i.current},T},[n,m,t,R,I,a]);return A}const M={loading:!1,networkError:!1,inputItems:[]};function C(s,t){switch(t.type){case"START_LOADING":return{loading:!0,networkError:!1,inputItems:[]};case"SET_ERROR":return{loading:!1,networkError:!0,inputItems:[]};case"SET_INPUT_ITEMS":return{loading:!1,networkError:!1,inputItems:t.payload.items};case"RESET_INPUT_ITEMS":return M;default:return s}}function P(s){const[{loading:t,networkError:l,inputItems:S},c]=r.useReducer(C,M),f=r.useRef(),e=r.useRef({}),p=r.useMemo(()=>async function(n){const I=f.current={};try{const m=await s(n),R=x(m,n);if(e.current[n]=R,I!==f.current)return;f.current=void 0,c({type:"SET_INPUT_ITEMS",payload:{items:R}})}catch{c({type:"SET_ERROR"})}},[s]),d=N(p,200),i=r.useMemo(()=>function(n){n=(n==null?void 0:n.toLowerCase())??"";const I=e.current[n];if(I){c({type:"SET_INPUT_ITEMS",payload:{items:I}});return}c({type:"START_LOADING"}),d(n)},[d]),w=r.useCallback(({isOpen:a,inputValue:n=""})=>{a&&i(n)},[i]),E=r.useCallback(({isOpen:a,inputValue:n=""})=>{a&&i(n)},[i]);return{loading:t,networkError:l,inputItems:S,onInputValueChange:w,onIsOpenChange:E}}export{P as u};
