{"version":3,"file":"Modal.stories-4b176e84.js","sources":["../../../../packages/react/src/modal/ModalCover.tsx","../../../../packages/react/src/modal/ModalTitle.tsx","../../../../packages/react/src/modal/utils.tsx","../../../../packages/react/src/modal/ModalDialog.tsx","../../../../packages/react/src/modal/Modal.tsx"],"sourcesContent":["import { forwardRef, ReactNode } from 'react';\n\nexport type ModalCoverProps = { children: ReactNode };\n\nexport const ModalCover = forwardRef<HTMLDivElement, ModalCoverProps>(\n\tfunction ModalCover({ children }, ref) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tref={ref}\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'fixed',\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tbackgroundColor: `rgba(0, 0, 0, 0.8)`,\n\t\t\t\t\tzIndex: 100,\n\t\t\t\t\toverflowY: 'auto',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n);\n","import { ReactNode } from 'react';\nimport { Text } from '../text';\n\nexport type ModalTitleProps = { children: ReactNode; id?: string };\n\nexport const ModalTitle = ({ children, id }: ModalTitleProps) => {\n\treturn (\n\t\t<Text\n\t\t\tas=\"h2\"\n\t\t\tfontSize=\"lg\"\n\t\t\tfontWeight=\"bold\"\n\t\t\tlineHeight=\"heading\"\n\t\t\tid={id}\n\t\t\tdata-autofocus\n\t\t\tfocus\n\t\t\ttabIndex={-1}\n\t\t>\n\t\t\t{children}\n\t\t</Text>\n\t);\n};\n","import { useId } from '../core';\n\nexport const useModalId = () => {\n\tconst id = useId();\n\treturn {\n\t\ttitleId: `modal-${id}-title`,\n\t};\n};\n","import { PropsWithChildren, ReactNode } from 'react';\nimport FocusLock from 'react-focus-lock';\nimport { animated, useSpring } from '@react-spring/web';\nimport { Box, Stack } from '../box';\nimport { usePrefersReducedMotion, mapSpacing, tokens } from '../core';\nimport { CloseIcon } from '../icon';\nimport { Button } from '../button';\nimport { ModalTitle } from './ModalTitle';\nimport { useModalId } from './utils';\n\nexport type ModalDialogProps = PropsWithChildren<{\n\t/** The actions to display at the bottom of the modal panel. Typically a `ButtonGroup`. */\n\tactions?: ReactNode;\n\t/** Function to be called when the modal is closed. */\n\tonDismiss: () => void;\n\t/** The title of the modal dialog. It can span lines but should not be too long. */\n\ttitle: string;\n}>;\n\nconst AnimatedStack = animated(Stack);\n\nexport const ModalDialog = ({\n\tactions,\n\tchildren,\n\ttitle,\n\tonDismiss,\n}: ModalDialogProps) => {\n\tconst { titleId } = useModalId();\n\n\tconst prefersReducedMotion = usePrefersReducedMotion();\n\tconst animationStyles = useSpring({\n\t\tfrom: { y: 20, opacity: 0 },\n\t\tto: { y: 0, opacity: 1 },\n\t\timmediate: prefersReducedMotion,\n\t});\n\n\treturn (\n\t\t<FocusLock returnFocus>\n\t\t\t<AnimatedStack\n\t\t\t\trole=\"dialog\"\n\t\t\t\taria-modal=\"true\"\n\t\t\t\tbackground=\"body\"\n\t\t\t\taria-labelledby={titleId}\n\t\t\t\trounded\n\t\t\t\tfocus\n\t\t\t\tpadding={1.5}\n\t\t\t\tpaddingTop={4}\n\t\t\t\tgap={1}\n\t\t\t\tmaxWidth={tokens.maxWidth.modalDialog}\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\tmargin: '0 auto',\n\t\t\t\t\tminHeight: '100vh',\n\t\t\t\t\t[tokens.mediaQuery.min.sm]: {\n\t\t\t\t\t\tmargin: `${mapSpacing(6)} auto ${mapSpacing(1)}`,\n\t\t\t\t\t\tminHeight: 'auto',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t\tstyle={animationStyles}\n\t\t\t>\n\t\t\t\t<ModalTitle id={titleId}>{title}</ModalTitle>\n\t\t\t\t<Box>{children}</Box>\n\t\t\t\t{actions ? (\n\t\t\t\t\t<Box paddingTop={1} css={{ marginTop: 'auto' }}>\n\t\t\t\t\t\t{actions}\n\t\t\t\t\t</Box>\n\t\t\t\t) : null}\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\taria-label=\"Close modal\"\n\t\t\t\t\tonClick={onDismiss}\n\t\t\t\t\ticonAfter={CloseIcon}\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: mapSpacing(0.5),\n\t\t\t\t\t\tright: mapSpacing(0.5),\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tClose\n\t\t\t\t</Button>\n\t\t\t</AnimatedStack>\n\t\t</FocusLock>\n\t);\n};\n","import { Fragment, FunctionComponent, useEffect, useRef } from 'react';\nimport { Global } from '@emotion/react';\nimport { createPortal } from 'react-dom';\nimport { ModalCover } from './ModalCover';\nimport { ModalDialog, ModalDialogProps } from './ModalDialog';\n\nexport type ModalProps = ModalDialogProps & {\n\t/** If true, the modal will be rendered.  */\n\tisOpen?: boolean;\n};\n\nexport const Modal: FunctionComponent<ModalProps> = ({\n\tactions,\n\tchildren,\n\tisOpen = false,\n\tonDismiss,\n\ttitle,\n}) => {\n\tconst coverRef = useRef<HTMLDivElement>(null);\n\n\t// Close the modal when the user presses the escape key\n\tuseEffect(() => {\n\t\tconst handleKeyDown = (e: KeyboardEvent) => {\n\t\t\tif (isOpen && e.code === 'Escape') {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tonDismiss();\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('keydown', handleKeyDown);\n\t\treturn () => window.removeEventListener('keydown', handleKeyDown);\n\t}, [isOpen, onDismiss]);\n\n\t// The following `useEffect` will add `aria-hidden=\"true\"` to every direct child of the `body` element when the modal is opened.\n\t// This is because `aria-modal` is not yet supported by all browsers (https://a11ysupport.io/tech/aria/aria-modal_attribute).\n\t// This fixes a bug in certain devices where focus is not trapped correctly such as VoiceOver on iOS.\n\t// This has been inspired by Reach UI (https://github.com/reach/reach-ui/blob/main/packages/dialog/src/index.tsx)\n\tuseEffect(() => {\n\t\tif (!isOpen || !coverRef.current) return;\n\n\t\tconst rootNodes: Element[] = [];\n\t\tconst originalAttrs: (string | null)[] = [];\n\n\t\tdocument.querySelectorAll('body > *').forEach(function (node) {\n\t\t\tif (node === coverRef.current) return;\n\t\t\tconst attr = node.getAttribute('aria-hidden');\n\t\t\tconst alreadyHidden = attr !== null && attr !== 'false';\n\t\t\tif (alreadyHidden) return;\n\t\t\trootNodes.push(node);\n\t\t\toriginalAttrs.push(attr);\n\t\t\tnode.setAttribute('aria-hidden', 'true');\n\t\t});\n\n\t\treturn () => {\n\t\t\trootNodes.forEach((node, index) => {\n\t\t\t\tconst originalValue = originalAttrs[index];\n\t\t\t\tif (originalValue === null) {\n\t\t\t\t\tnode.removeAttribute('aria-hidden');\n\t\t\t\t} else {\n\t\t\t\t\tnode.setAttribute('aria-hidden', originalValue);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t}, [isOpen]);\n\n\tif (!isOpen) return null;\n\n\treturn createPortal(\n\t\t<Fragment>\n\t\t\t<LockScroll />\n\t\t\t<ModalCover ref={coverRef}>\n\t\t\t\t<ModalDialog onDismiss={onDismiss} title={title} actions={actions}>\n\t\t\t\t\t{children}\n\t\t\t\t</ModalDialog>\n\t\t\t</ModalCover>\n\t\t</Fragment>,\n\t\tdocument.body\n\t);\n};\n\nconst LockScroll = () => <Global styles={{ body: { overflow: 'hidden' } }} />;\n"],"names":["ModalCover","forwardRef","children","ref","jsx","ModalTitle","id","Text","useModalId","useId","AnimatedStack","animated","Stack","ModalDialog","actions","title","onDismiss","titleId","prefersReducedMotion","usePrefersReducedMotion","animationStyles","useSpring","FocusLock","jsxs","tokens","mapSpacing","Box","Button","CloseIcon","Modal","isOpen","coverRef","useRef","useEffect","handleKeyDown","e","rootNodes","originalAttrs","node","attr","index","originalValue","createPortal","Fragment","LockScroll","Global"],"mappings":"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"}